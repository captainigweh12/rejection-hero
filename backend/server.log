+ exec gosu vibecode scripts/start --hot
Installing dependencies and generating Prisma client...
[0.03ms] ".env"
bun install v1.2.19 (aad3abea)

$ prisma generate
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma

âœ” Generated Prisma Client (v6.17.1) to ./generated/prisma in 352ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Want to turn off tips and other hints? https://pris.ly/tip-4-nohints


Checked 760 installs across 702 packages (no changes) [1.72s]
Starting server in dev mode with hot reload...
$ NODE_ENV=development bun run --hot src/index.ts
Failed to find Response internal state key
âœ… Environment variables validated successfully
ğŸ” [Auth] Initializing Better Auth...
âœ… [Auth] Better Auth initialized
ğŸ”— [Auth] Base URL: https://preview-csuipnvqjxpr.share.sandbox.dev
ğŸŒ [Auth] Trusted origins: vibecode://, http://localhost:3000, http://localhost:8081, https://preview-csuipnvqjxpr.share.sandbox.dev
ğŸ”‘ [Auth] Google OAuth: Enabled
ğŸ“ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
ğŸ”§ Initializing Hono application...
ğŸ” Mounting Better Auth handler at /api/auth/*
ğŸ“ Serving static files from uploads/ directory
ğŸ“¤ Mounting upload routes at /api/upload
ğŸ“ Mounting sample routes at /api/sample
ğŸ‘¤ Mounting profile routes at /api/profile
ğŸ” Mounting discover routes at /api/discover
ğŸ‘† Mounting swipe routes at /api/swipe
ğŸ’• Mounting matches routes at /api/matches
ğŸ¯ Mounting quests routes at /api/quests
ğŸ“Š Mounting stats routes at /api/stats
ğŸ“¹ Mounting live routes at /api/live
ğŸ‘¥ Mounting friends routes at /api/friends
ğŸ’¬ Mounting messages routes at /api/messages
ğŸ˜ï¸  Mounting groups routes at /api/groups
ğŸ Mounting shared quests routes at /api/shared-quests
ğŸ““ Mounting journal routes at /api/journal
ğŸ“ Mounting posts routes at /api/posts
â° Mounting moments routes at /api/moments
âš™ï¸  Starting server...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Environment: development
ğŸš€ Server is running on port 3000
ğŸ”— Base URL: http://localhost:3000
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š Available endpoints:
  ğŸ” Auth:         /api/auth/*
  ğŸ“¤ Upload:       POST /api/upload/image
  ğŸ“ Sample:       GET/POST /api/sample
  ğŸ‘¤ Profile:      GET/POST /api/profile
  ğŸ” Discover:     GET /api/discover
  ğŸ‘† Swipe:        POST /api/swipe
  ğŸ’• Matches:      GET /api/matches
  ğŸ¯ Quests:       GET/POST /api/quests
  ğŸ“Š Stats:        GET /api/stats
  ğŸ“¹ Live:         GET/POST /api/live
  ğŸ‘¥ Friends:      GET/POST /api/friends
  ğŸ’¬ Messages:     GET/POST /api/messages
  ğŸ˜ï¸  Groups:       GET/POST /api/groups
  ğŸ SharedQuests: GET/POST /api/shared-quests
  ğŸ““ Journal:      GET/POST /api/journal
  ğŸ’š Health:       GET /health
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Failed to find Response internal state key
âœ… Environment variables validated successfully
ğŸ” [Auth] Initializing Better Auth...
âœ… [Auth] Better Auth initialized
ğŸ”— [Auth] Base URL: https://preview-csuipnvqjxpr.share.sandbox.dev
ğŸŒ [Auth] Trusted origins: vibecode://, http://localhost:3000, http://localhost:8081, https://preview-csuipnvqjxpr.share.sandbox.dev
ğŸ”‘ [Auth] Google OAuth: Enabled
ğŸ“ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
ğŸ”§ Initializing Hono application...
ğŸ” Mounting Better Auth handler at /api/auth/*
ğŸ“ Serving static files from uploads/ directory
ğŸ“¤ Mounting upload routes at /api/upload
ğŸ“ Mounting sample routes at /api/sample
ğŸ‘¤ Mounting profile routes at /api/profile
ğŸ” Mounting discover routes at /api/discover
ğŸ‘† Mounting swipe routes at /api/swipe
ğŸ’• Mounting matches routes at /api/matches
ğŸ¯ Mounting quests routes at /api/quests
ğŸ“Š Mounting stats routes at /api/stats
ğŸ“¹ Mounting live routes at /api/live
ğŸ‘¥ Mounting friends routes at /api/friends
ğŸ’¬ Mounting messages routes at /api/messages
ğŸ˜ï¸  Mounting groups routes at /api/groups
ğŸ Mounting shared quests routes at /api/shared-quests
ğŸ““ Mounting journal routes at /api/journal
ğŸ“ Mounting posts routes at /api/posts
â° Mounting moments routes at /api/moments
âš™ï¸  Starting server...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Environment: development
ğŸš€ Server is running on port 3000
ğŸ”— Base URL: http://localhost:3000
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š Available endpoints:
  ğŸ” Auth:         /api/auth/*
  ğŸ“¤ Upload:       POST /api/upload/image
  ğŸ“ Sample:       GET/POST /api/sample
  ğŸ‘¤ Profile:      GET/POST /api/profile
  ğŸ” Discover:     GET /api/discover
  ğŸ‘† Swipe:        POST /api/swipe
  ğŸ’• Matches:      GET /api/matches
  ğŸ¯ Quests:       GET/POST /api/quests
  ğŸ“Š Stats:        GET /api/stats
  ğŸ“¹ Live:         GET/POST /api/live
  ğŸ‘¥ Friends:      GET/POST /api/friends
  ğŸ’¬ Messages:     GET/POST /api/messages
  ğŸ˜ï¸  Groups:       GET/POST /api/groups
  ğŸ SharedQuests: GET/POST /api/shared-quests
  ğŸ““ Journal:      GET/POST /api/journal
  ğŸ’š Health:       GET /health
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

<-- GET /api/auth/get-session
--> GET /api/auth/get-session [32m200[0m 13ms
<-- GET /api/stats
--> GET /api/stats [32m200[0m 3ms
<-- GET /api/stats/reflection-prompt
<-- GET /api/quests
--> GET /api/stats/reflection-prompt [32m200[0m 4ms
<-- GET /api/stats/weekly-forecast
--> GET /api/quests [32m200[0m 8ms
--> GET /api/stats/weekly-forecast [32m200[0m 6ms
<-- GET /api/stats
<-- GET /api/stats/leaderboard
--> GET /api/stats [32m200[0m 3ms
--> GET /api/stats/leaderboard [32m200[0m 5ms
<-- GET /api/quests
--> GET /api/quests [32m200[0m 4ms
<-- POST /api/quests/cmi09zby50002m2ewbim7geos/record
--> POST /api/quests/cmi09zby50002m2ewbim7geos/record [32m200[0m 10ms
<-- GET /api/quests
<-- GET /api/stats
--> GET /api/quests [32m200[0m 5ms
--> GET /api/stats [32m200[0m 3ms
<-- GET /api/stats/leaderboard
--> GET /api/stats/leaderboard [32m200[0m 4ms
<-- POST /api/quests/generate
Using OpenAI API to generate quest
Fetching nearby places for New York, NY at 40.66817025536199, -73.78545837874242
Found 10 nearby places
<-- POST /api/quests/generate
Using OpenAI API to generate quest
Fetching nearby places for New York, NY at 40.66817025536199, -73.78545837874242
Found 10 nearby places
<-- POST /api/quests/generate
Using OpenAI API to generate quest
Fetching nearby places for New York, NY at 40.66817025536199, -73.78545837874242
Found 10 nearby places
<-- POST /api/quests/generate
Using OpenAI API to generate quest
Fetching nearby places for New York, NY at 40.66817025536199, -73.78545837874242
Found 10 nearby places
OpenAI API response: {
  "id": "chatcmpl-Cc9tnK3H9q7mM6cE4vMTiwSG5421H",
  "object": "chat.completion",
  "created": 1763210551,
  "model": "gpt-4o-mini-2024-07-18",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "{\n  \"title\": \"Request Free Upgrade\",\n  \"description\": \"Visit the Hampton Inn NY-JFK and ask the front desk if they could provide you with a complimentary room upgrade. Approach them with a friendly attitude and a smile, explaining that you're celebrating a special occasion.\",\n  \"category\": \"CONFIDENCE\",\n  \"difficulty\": \"MEDIUM\",\n  \"goalType\": \"COLLECT_NOS\",\n  \"goalCount\": 1,\n  \"location\": \"Hampton Inn NY-JFK - 144-10 135th Avenue, Jamaica\",\n  \"latitude\": 40.6674305,\n  \"longitude\": -73.7947628\n}",
        "refusal": null,
        "annotations": []
      },
      "logprobs": null,
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 2796,
    "completion_tokens": 138,
    "total_tokens": 2934,
    "prompt_tokens_details": {
      "cached_tokens": 0,
      "audio_tokens": 0
    },
    "completion_tokens_details": {
      "reasoning_tokens": 0,
      "audio_tokens": 0,
      "accepted_prediction_tokens": 0,
      "rejected_prediction_tokens": 0
    }
  },
  "service_tier": "default",
  "system_fingerprint": "fp_51db84afab"
}
<-- POST /api/quests/generate
Using OpenAI API to generate quest
Fetching nearby places for New York, NY at 40.66817025536199, -73.78545837874242
Found 10 nearby places
--> POST /api/quests/generate [32m200[0m 6s
<-- GET /api/quests
--> GET /api/quests [32m200[0m 5ms
OpenAI API response: {
  "id": "chatcmpl-Cc9tozbAFNjs51LPtNRw9CaW3AxzF",
  "object": "chat.completion",
  "created": 1763210552,
  "model": "gpt-4o-mini-2024-07-18",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "{\n  \"title\": \"Request Free Samples\",\n  \"description\": \"Visit the Best Western JFK Airport Hotel and ask the front desk clerk if they have any complimentary toiletries or snacks available for guests. Be friendly and confident as you make your request, and don't hesitate to ask follow-up questions if they say no. This is a great way to practice handling rejection while engaging in casual conversation.\",\n  \"category\": \"CONFIDENCE\",\n  \"difficulty\": \"MEDIUM\",\n  \"goalType\": \"COLLECT_NOS\",\n  \"goalCount\": 1,\n  \"location\": \"Best Western JFK Airport Hotel - 144-25 153rd Lane, Jamaica\",\n  \"latitude\": 40.665615,\n  \"longitude\": -73.784698\n}",
        "refusal": null,
        "annotations": []
      },
      "logprobs": null,
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 2796,
    "completion_tokens": 157,
    "total_tokens": 2953,
    "prompt_tokens_details": {
      "cached_tokens": 2688,
      "audio_tokens": 0
    },
    "completion_tokens_details": {
      "reasoning_tokens": 0,
      "audio_tokens": 0,
      "accepted_prediction_tokens": 0,
      "rejected_prediction_tokens": 0
    }
  },
  "service_tier": "default",
  "system_fingerprint": "fp_51db84afab"
}
OpenAI API response: {
  "id": "chatcmpl-Cc9to39KKAEroRVMXPIjp6JHFmhH3",
  "object": "chat.completion",
  "created": 1763210552,
  "model": "gpt-4o-mini-2024-07-18",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "{\n  \"title\": \"Request Free Postcards\",\n  \"description\": \"Visit the JFK Inn at JFK Airport and ask the front desk if they have any free postcards available for guests. This is a great way to practice your request skills while connecting with travelers.\",\n  \"category\": \"CONFIDENCE\",\n  \"difficulty\": \"MEDIUM\",\n  \"goalType\": \"COLLECT_NOS\",\n  \"goalCount\": 5,\n  \"location\": \"JFK Inn - 154-10 South Conduit Avenue, Jamaica\",\n  \"latitude\": 40.6661714,\n  \"longitude\": -73.78217029999999\n}",
        "refusal": null,
        "annotations": []
      },
      "logprobs": null,
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 2796,
    "completion_tokens": 134,
    "total_tokens": 2930,
    "prompt_tokens_details": {
      "cached_tokens": 2688,
      "audio_tokens": 0
    },
    "completion_tokens_details": {
      "reasoning_tokens": 0,
      "audio_tokens": 0,
      "accepted_prediction_tokens": 0,
      "rejected_prediction_tokens": 0
    }
  },
  "service_tier": "default",
  "system_fingerprint": "fp_51db84afab"
}
Unsafe quest generated, rejecting: Quest contains potentially harmful content: "kill". For your safety, we cannot create quests that may cause physical harm, involve illegal activities, or endanger others.
AI generation failed, using predefined quest: 689 |       customPrompt || ""
690 |     );
691 | 
692 |     if (!safetyCheck.isSafe) {
693 |       console.error("Unsafe quest generated, rejecting:", safetyCheck.reason);
694 |       throw new Error(
                  ^
error: Quest contains potentially harmful content: "kill". For your safety, we cannot create quests that may cause physical harm, involve illegal activities, or endanger others.
      at generateQuestWithAI (/home/user/workspace/backend/src/routes/quests.ts:694:13)

--> POST /api/quests/generate [32m200[0m 4s
<-- POST /api/quests/cmi0a1g4i0004m264ms8x25zo/start
--> POST /api/quests/cmi0a1g4i0004m264ms8x25zo/start [32m200[0m 4ms
<-- GET /api/quests
--> GET /api/quests [32m200[0m 5ms
<-- GET /api/quests
--> GET /api/quests [32m200[0m 4ms
<-- POST /api/quests/cmi0a1gal0007m26421esout3/start
--> POST /api/quests/cmi0a1gal0007m26421esout3/start [33m400[0m 3ms
<-- GET /api/stats
<-- GET /api/stats/weekly-forecast
--> GET /api/stats [32m200[0m 5ms
--> GET /api/stats/weekly-forecast [32m200[0m 5ms
<-- GET /api/quests
--> GET /api/quests [32m200[0m 3ms
<-- GET /api/stats/reflection-prompt
--> GET /api/stats/reflection-prompt [32m200[0m 2ms
--> POST /api/quests/generate [32m200[0m 6s
<-- GET /api/quests
--> GET /api/quests [32m200[0m 7ms
<-- POST /api/quests/cmi0a1gwe000am264xva1dogp/start
--> POST /api/quests/cmi0a1gwe000am264xva1dogp/start [33m400[0m 3ms
OpenAI API response: {
  "id": "chatcmpl-Cc9trUSwampq56d4xPByJD0KE1wS5",
  "object": "chat.completion",
  "created": 1763210555,
  "model": "gpt-4o-mini-2024-07-18",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "{\n  \"title\": \"Request Free Samples\",\n  \"description\": \"Visit the Best Western JFK Airport Hotel and ask the front desk for free samples of their welcome kits or promotional materials. It's a great chance to practice your approach at a busy hotel where guests expect to receive helpful information.\",\n  \"category\": \"CONFIDENCE\",\n  \"difficulty\": \"MEDIUM\",\n  \"goalType\": \"COLLECT_NOS\",\n  \"goalCount\": 1,\n  \"location\": \"Best Western JFK Airport Hotel - 144-25 153rd Lane, Jamaica\",\n  \"latitude\": 40.665615,\n  \"longitude\": -73.784698\n}",
        "refusal": null,
        "annotations": []
      },
      "logprobs": null,
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 2796,
    "completion_tokens": 137,
    "total_tokens": 2933,
    "prompt_tokens_details": {
      "cached_tokens": 2688,
      "audio_tokens": 0
    },
    "completion_tokens_details": {
      "reasoning_tokens": 0,
      "audio_tokens": 0,
      "accepted_prediction_tokens": 0,
      "rejected_prediction_tokens": 0
    }
  },
  "service_tier": "default",
  "system_fingerprint": "fp_51db84afab"
}
--> POST /api/quests/generate [32m200[0m 4s
<-- GET /api/quests
--> GET /api/quests [32m200[0m 4ms
OpenAI API response: {
  "id": "chatcmpl-Cc9trryp61nd4M52a7FK8cl587xA1",
  "object": "chat.completion",
  "created": 1763210555,
  "model": "gpt-4o-mini-2024-07-18",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "{\n  \"title\": \"Request Free Stickers\",\n  \"description\": \"Visit the Best Western JFK Airport Hotel and ask the front desk if they have any promotional stickers available for guests. Be friendly and genuine in your request to make the experience comfortable and engaging.\",\n  \"category\": \"CONFIDENCE\",\n  \"difficulty\": \"MEDIUM\",\n  \"goalType\": \"COLLECT_NOS\",\n  \"goalCount\": 5,\n  \"location\": \"Best Western JFK Airport Hotel - 144-25 153rd Lane, Jamaica\",\n  \"latitude\": 40.665615,\n  \"longitude\": -73.784698\n}",
        "refusal": null,
        "annotations": []
      },
      "logprobs": null,
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 2796,
    "completion_tokens": 132,
    "total_tokens": 2928,
    "prompt_tokens_details": {
      "cached_tokens": 0,
      "audio_tokens": 0
    },
    "completion_tokens_details": {
      "reasoning_tokens": 0,
      "audio_tokens": 0,
      "accepted_prediction_tokens": 0,
      "rejected_prediction_tokens": 0
    }
  },
  "service_tier": "default",
  "system_fingerprint": "fp_560af6e559"
}
<-- POST /api/quests/cmi0a1ii0000dm2642pkiwjy9/start
--> POST /api/quests/cmi0a1ii0000dm2642pkiwjy9/start [33m400[0m 2ms
--> POST /api/quests/generate [32m200[0m 4s
<-- GET /api/quests
--> GET /api/quests [32m200[0m 3ms
<-- POST /api/quests/cmi0a1isv000gm264f2pccjp7/start
--> POST /api/quests/cmi0a1isv000gm264f2pccjp7/start [33m400[0m 5ms
<-- GET /api/quests
--> GET /api/quests [32m200[0m 5ms
<-- GET /api/stats
--> GET /api/stats [32m200[0m 2ms
<-- GET /api/stats/leaderboard
--> GET /api/stats/leaderboard [32m200[0m 3ms
<-- GET /api/quests
<-- GET /api/stats
--> GET /api/quests [32m200[0m 4ms
--> GET /api/stats [32m200[0m 5ms
<-- GET /api/stats/leaderboard
--> GET /api/stats/leaderboard [32m200[0m 3ms
